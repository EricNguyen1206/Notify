(()=>{var a={};a.id=299,a.ids=[299],a.modules={106:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(1404).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/ericnguyen/DATA_ERIC/Workspace/Backend/go/Notify/apps/web/src/app/messages/[id]/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/ericnguyen/DATA_ERIC/Workspace/Backend/go/Notify/apps/web/src/app/messages/[id]/page.tsx","default")},261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3131:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(25760),e=c(21279),f=c(57785),g=c(88982),h=c(80888),i=c(47210),j=c(27217),k=c(10498),l=c(97288),m=c(54930),n=c(53148),o=c(39419),p=c(63023),q=c(91700),r=c(261),s=c(16651),t=c(17448),u=c(26713),v=c(57810),w=c(31367),x=c(84475),y=c(95628),z=c(47084),A=c(60044),B=c(86439),C=c(66916),D=c.n(C),E=c(18792),F=c(4689),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["messages",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,106)),"/Users/ericnguyen/DATA_ERIC/Workspace/Backend/go/Notify/apps/web/src/app/messages/[id]/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,50949)),"/Users/ericnguyen/DATA_ERIC/Workspace/Backend/go/Notify/apps/web/src/app/messages/layout.tsx"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,2144))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(c.bind(c,86e3)),"/Users/ericnguyen/DATA_ERIC/Workspace/Backend/go/Notify/apps/web/src/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,66916,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.bind(c,63889)),"/Users/ericnguyen/DATA_ERIC/Workspace/Backend/go/Notify/apps/web/src/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,91587,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,71622,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,2144))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,I=["/Users/ericnguyen/DATA_ERIC/Workspace/Backend/go/Notify/apps/web/src/app/messages/[id]/page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/messages/[id]/page",pathname:"/messages/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/messages/[id]/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:a=>{"use strict";a.exports=require("assert")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:a=>{"use strict";a.exports=require("os")},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},35363:(a,b,c)=>{Promise.resolve().then(c.bind(c,75202))},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},59339:(a,b,c)=>{Promise.resolve().then(c.bind(c,106))},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73496:a=>{"use strict";a.exports=require("http2")},74075:a=>{"use strict";a.exports=require("zlib")},75202:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>aF});var d=c(54986),e=c(57011),f=c(78852),g=c(94223);let h=(0,g.A)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),i=(0,g.A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),j=(0,g.A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var k=c(92975);let l=(0,g.A)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var m=c(40412),n=c(26883),o=c(60099),p=c(46442),q=c(24856),r=c(4502),s=c(20380),t=c(86135);function u({isOpen:a,onClose:b,members:c,channelName:g}){let[h,i]=(0,e.useState)(""),j=(0,e.useMemo)(()=>{if(!h.trim())return c;let a=h.toLowerCase();return c.filter(b=>(b.username?.toLowerCase().includes(a)??!1)||(b.email?.toLowerCase().includes(a)??!1))},[c,h]);return(0,d.jsx)(s.lG,{open:a,onOpenChange:b,children:(0,d.jsxs)(s.Cf,{className:"sm:max-w-[500px]",children:[(0,d.jsx)(s.c7,{children:(0,d.jsxs)(s.L3,{className:"flex items-center gap-2",children:[(0,d.jsx)(f.A,{className:"w-5 h-5"}),"Members of #",g]})}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(p.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,d.jsx)(r.p,{placeholder:"Search members...",value:h,onChange:a=>i(a.target.value),className:"pl-10 pr-10"}),h&&(0,d.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>{i("")},className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7 p-0 hover:bg-muted",children:(0,d.jsx)(q.A,{className:"w-4 h-4"})})]}),(0,d.jsx)("div",{className:"max-h-[400px] overflow-y-auto space-y-3",children:0===j.length?(0,d.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:h?"No members found matching your search.":"No members in this channel."}):j.map(a=>(0,d.jsxs)("div",{className:"flex items-center space-x-3 p-3 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[(0,d.jsxs)(t.eu,{className:"w-10 h-10",children:[(0,d.jsx)(t.BK,{src:a.avatar,alt:a.username||"User"}),(0,d.jsx)(t.q5,{children:(a.username?.charAt(0)||"U").toUpperCase()})]}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("p",{className:"font-medium text-sm truncate",children:a.username||"Unknown User"}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:a.email||"No email"})]})]},a.id))}),(0,d.jsxs)("div",{className:"flex justify-between items-center pt-2 border-t",children:[(0,d.jsxs)("span",{className:"text-sm text-muted-foreground",children:[j.length," of ",c.length," members"]}),(0,d.jsx)(m.$,{variant:"outline",onClick:b,children:"Close"})]})]})]})})}var v=c(33048),w=c(74236),x=c(52207),y=c(19421),z=c(34634);function A(a){let[b,c]=(0,e.useState)(!1),g=(0,w.useRouter)(),{removeConversation:p}=(0,x.w)(),{leaveConversation:q}=(0,y.Us)(),r=a.currentUserId===a.ownerId,s=(0,v.Hy)({onSuccess:()=>{let b=a.isGroup?"group":"direct";p(a.id,b);try{q(a.id)}catch(a){}z.oR.success("Successfully left the conversation"),g.push("/messages")},onError:()=>{z.oR.error("Failed to leave conversation. Please try again.")}}),t=(0,v.t7)({onSuccess:()=>{let b=a.isGroup?"group":"direct";p(a.id,b);try{q(a.id)}catch(a){}z.oR.success("Conversation deleted successfully"),g.push("/messages")},onError:()=>{z.oR.error("Failed to delete conversation. Please try again.")}});return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-chat-outer bg-background border-b border-t border-chat-border",children:[(0,d.jsxs)(o.rI,{children:[(0,d.jsx)(o.ty,{asChild:!0,children:(0,d.jsx)(m.$,{variant:"ghost",className:"h-auto p-0 hover:bg-transparent focus:bg-transparent",children:(0,d.jsxs)("div",{className:"flex items-center space-x-3 cursor-pointer hover:bg-accent/50 rounded-lg p-2 transition-colors",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"font-medium text-foreground",children:`#${a.name}`}),a.isGroup?(0,d.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-muted-foreground",children:[(0,d.jsx)(f.A,{className:"w-3 h-3"}),(0,d.jsxs)("span",{className:"font-normal",children:[a.participantCount," members"]})]}):(0,d.jsx)("p",{className:"text-sm text-chat-accent font-normal",children:a.isOnline?"Online":"Offline"})]}),(0,d.jsx)(h,{className:"w-4 h-4 text-muted-foreground"})]})})}),(0,d.jsxs)(o.SQ,{align:"start",className:"w-56",children:[(0,d.jsxs)(o._2,{onClick:()=>{c(!0)},children:[(0,d.jsx)(i,{className:"mr-2 h-4 w-4"}),(0,d.jsx)("span",{children:"View members"})]}),(0,d.jsx)(o.mB,{}),r?(0,d.jsxs)(o._2,{onClick:()=>{let b=a.name;confirm(a.isGroup?`Are you sure you want to delete the group conversation "#${b}"? This action cannot be undone and all members will lose access to this conversation.`:`Are you sure you want to delete the direct message with "${b}"? This action cannot be undone.`)&&t.mutate(a.id)},className:"text-red-600 focus:text-red-600",disabled:t.isPending,children:[(0,d.jsx)(j,{className:"mr-2 h-4 w-4"}),(0,d.jsx)("span",{children:t.isPending?"Deleting...":"Delete conversation"})]}):(0,d.jsxs)(o._2,{onClick:()=>{confirm("Are you sure you want to leave this conversation?")&&s.mutate(a.id)},className:"text-orange-600 focus:text-orange-600",disabled:s.isPending,children:[(0,d.jsx)(k.A,{className:"mr-2 h-4 w-4"}),(0,d.jsx)("span",{children:s.isPending?"Leaving...":"Leave conversation"})]})]})]}),(0,d.jsx)("div",{className:"flex items-center space-x-2",children:(0,d.jsx)(n.Bc,{children:(0,d.jsxs)(n.m_,{children:[(0,d.jsx)(n.k$,{asChild:!0,children:(0,d.jsx)(m.$,{variant:"ghost",size:"sm",className:"h-9 w-9 p-0 hover:bg-chat-accent/10 cursor-not-allowed",children:(0,d.jsx)(l,{className:"w-4 h-4 text-muted-foreground"})})}),(0,d.jsx)(n.ZI,{children:(0,d.jsx)("p",{children:"Upcomming feature"})})]})})})]}),(0,d.jsx)(u,{isOpen:b,onClose:()=>c(!1),members:a.members||[],channelName:a.name})]})}function B({message:a,isGroup:b,userId:c}){return a.senderId==c?(0,d.jsx)("div",{className:"flex justify-end mb-chat-gutter",children:(0,d.jsxs)("div",{className:"max-w-xs lg:max-w-md",children:[(0,d.jsx)("div",{className:"bg-chat-primary text-white rounded-chat px-4 py-2",children:(0,d.jsx)("p",{className:"break-words font-normal",children:a.text})}),(0,d.jsx)("div",{className:"flex justify-end mt-1",children:(0,d.jsx)("span",{className:"text-xs text-gray-500 font-normal",children:new Date(a.createdAt).toLocaleString()})})]})}):(0,d.jsxs)("div",{className:"flex items-start mb-chat-gutter",children:[b&&(0,d.jsxs)(t.eu,{className:"w-8 h-8 mr-2 flex-shrink-0",children:[(0,d.jsx)(t.BK,{src:a.senderAvatar}),(0,d.jsx)(t.q5,{className:"bg-chat-primary text-white",children:a.senderName?.[0]?.toUpperCase()??"A"})]}),(0,d.jsxs)("div",{className:"max-w-xs lg:max-w-md",children:[b&&(0,d.jsx)("p",{className:"text-sm font-medium text-foreground mb-1",children:a.senderName??"Sender"}),(0,d.jsx)("div",{className:"bg-card border border-chat-border rounded-chat px-4 py-2",children:(0,d.jsx)("p",{className:"text-card-foreground break-words font-normal",children:a.text})}),(0,d.jsx)("div",{className:"flex justify-start mt-1",children:(0,d.jsx)("span",{className:"text-xs text-gray-500 font-normal",children:new Date(a.createdAt).toLocaleString()})})]})]})}var C=c(32849);function D({isGroup:a}){return(0,d.jsx)("div",{className:"space-y-0",children:Array.from({length:6}).map((b,c)=>c%3==0?(0,d.jsx)("div",{className:"flex justify-end mb-4",children:(0,d.jsxs)("div",{className:"max-w-xs lg:max-w-md",children:[(0,d.jsxs)("div",{className:"bg-gray-200 rounded-lg rounded-br-sm px-4 py-2",children:[(0,d.jsx)(C.E,{className:"h-4 w-32 mb-1"}),c%2==0&&(0,d.jsx)(C.E,{className:"h-4 w-24"})]}),(0,d.jsx)("div",{className:"flex justify-end mt-1",children:(0,d.jsx)(C.E,{className:"h-3 w-12"})})]})},c):(0,d.jsxs)("div",{className:"flex items-start mb-4",children:[a&&(0,d.jsx)(C.E,{className:"w-8 h-8 rounded-full mr-2 flex-shrink-0"}),(0,d.jsxs)("div",{className:"max-w-xs lg:max-w-md",children:[a&&(0,d.jsx)(C.E,{className:"h-4 w-20 mb-1"}),(0,d.jsxs)("div",{className:"bg-gray-100 border border-gray-200 rounded-lg rounded-bl-sm px-4 py-2",children:[(0,d.jsx)(C.E,{className:"h-4 w-40 mb-1"}),c%3==1&&(0,d.jsx)(C.E,{className:"h-4 w-28"})]}),(0,d.jsx)("div",{className:"flex justify-start mt-1",children:(0,d.jsx)(C.E,{className:"h-3 w-12"})})]})]},c))})}let E=(0,g.A)("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]),F=(0,g.A)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),G=(0,g.A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);function H({onSendMessage:a,onStartTyping:b,onStopTyping:c,isConnected:f=!0,disabled:g=!1}){let h=(0,e.useRef)(null),i=()=>{let b=h.current?.value||"";b.trim()&&f&&!g&&(a(b.trim()),h.current&&(h.current.value=""))};return(0,d.jsxs)("div",{className:"p-chat-outer bg-background border-t border-chat-border",children:[!f&&(0,d.jsx)("div",{className:"mb-2 text-sm text-amber-600 bg-amber-50 border border-amber-200 rounded-chat px-3 py-1 font-normal",children:"Not connected to chat server"}),(0,d.jsxs)("div",{className:"h-[40px] flex items-center space-x-3",children:[(0,d.jsx)("div",{className:"flex-1 w-full",children:(0,d.jsxs)("div",{className:"h-[40px] flex items-center space-x-2 bg-input-background border border-chat-border rounded-chat px-3 py-2 w-full focus-within:border-chat-primary transition-colors",children:[(0,d.jsx)(m.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-chat-accent/10 cursor-not-allowed",children:(0,d.jsx)(E,{className:"w-4 h-4 text-muted-foreground"})}),(0,d.jsx)("input",{type:"text",ref:h,placeholder:g?"Chat disabled":f?"Type a message...":"Connecting...",onChange:a=>{a.target.value},onKeyPress:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),i())},disabled:g||!f,className:"flex-1 bg-transparent outline-none resize-none disabled:cursor-not-allowed disabled:text-gray-400 font-normal text-base"}),(0,d.jsx)(m.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-chat-accent/10 cursor-not-allowed",children:(0,d.jsx)(F,{className:"w-4 h-4 text-muted-foreground"})})]})}),(0,d.jsx)(m.$,{onClick:i,disabled:!(h.current?.value||"").trim()||g||!f,className:"h-10 w-10 p-0 bg-chat-primary hover:bg-chat-secondary disabled:bg-gray-300 rounded-chat",children:(0,d.jsx)(G,{className:"w-4 h-4"})})]})]})}var I=c(55516),J=c(10237),K=c(44384),L=c(3014),M=c(9397),N=c(88229),O=c(9669),P=c(30065),Q="ScrollArea",[R,S]=(0,K.A)(Q),[T,U]=R(Q),V=e.forwardRef((a,b)=>{let{__scopeScrollArea:c,type:f="hover",dir:g,scrollHideDelay:h=600,...i}=a,[j,k]=e.useState(null),[l,m]=e.useState(null),[n,o]=e.useState(null),[p,q]=e.useState(null),[r,s]=e.useState(null),[t,u]=e.useState(0),[v,w]=e.useState(0),[x,y]=e.useState(!1),[z,A]=e.useState(!1),B=(0,L.s)(b,a=>k(a)),C=(0,N.jH)(g);return(0,d.jsx)(T,{scope:c,type:f,dir:C,scrollHideDelay:h,scrollArea:j,viewport:l,onViewportChange:m,content:n,onContentChange:o,scrollbarX:p,onScrollbarXChange:q,scrollbarXEnabled:x,onScrollbarXEnabledChange:y,scrollbarY:r,onScrollbarYChange:s,scrollbarYEnabled:z,onScrollbarYEnabledChange:A,onCornerWidthChange:u,onCornerHeightChange:w,children:(0,d.jsx)(I.sG.div,{dir:C,...i,ref:B,style:{position:"relative","--radix-scroll-area-corner-width":t+"px","--radix-scroll-area-corner-height":v+"px",...a.style}})})});V.displayName=Q;var W="ScrollAreaViewport",X=e.forwardRef((a,b)=>{let{__scopeScrollArea:c,children:f,nonce:g,...h}=a,i=U(W,c),j=e.useRef(null),k=(0,L.s)(b,j,i.onViewportChange);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:g}),(0,d.jsx)(I.sG.div,{"data-radix-scroll-area-viewport":"",...h,ref:k,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...a.style},children:(0,d.jsx)("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:f})})]})});X.displayName=W;var Y="ScrollAreaScrollbar",Z=e.forwardRef((a,b)=>{let{forceMount:c,...f}=a,g=U(Y,a.__scopeScrollArea),{onScrollbarXEnabledChange:h,onScrollbarYEnabledChange:i}=g,j="horizontal"===a.orientation;return e.useEffect(()=>(j?h(!0):i(!0),()=>{j?h(!1):i(!1)}),[j,h,i]),"hover"===g.type?(0,d.jsx)($,{...f,ref:b,forceMount:c}):"scroll"===g.type?(0,d.jsx)(_,{...f,ref:b,forceMount:c}):"auto"===g.type?(0,d.jsx)(aa,{...f,ref:b,forceMount:c}):"always"===g.type?(0,d.jsx)(ab,{...f,ref:b}):null});Z.displayName=Y;var $=e.forwardRef((a,b)=>{let{forceMount:c,...f}=a,g=U(Y,a.__scopeScrollArea),[h,i]=e.useState(!1);return e.useEffect(()=>{let a=g.scrollArea,b=0;if(a){let c=()=>{window.clearTimeout(b),i(!0)},d=()=>{b=window.setTimeout(()=>i(!1),g.scrollHideDelay)};return a.addEventListener("pointerenter",c),a.addEventListener("pointerleave",d),()=>{window.clearTimeout(b),a.removeEventListener("pointerenter",c),a.removeEventListener("pointerleave",d)}}},[g.scrollArea,g.scrollHideDelay]),(0,d.jsx)(J.C,{present:c||h,children:(0,d.jsx)(aa,{"data-state":h?"visible":"hidden",...f,ref:b})})}),_=e.forwardRef((a,b)=>{var c;let{forceMount:f,...g}=a,h=U(Y,a.__scopeScrollArea),i="horizontal"===a.orientation,j=at(()=>l("SCROLL_END"),100),[k,l]=(c={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},e.useReducer((a,b)=>c[a][b]??a,"hidden"));return e.useEffect(()=>{if("idle"===k){let a=window.setTimeout(()=>l("HIDE"),h.scrollHideDelay);return()=>window.clearTimeout(a)}},[k,h.scrollHideDelay,l]),e.useEffect(()=>{let a=h.viewport,b=i?"scrollLeft":"scrollTop";if(a){let c=a[b],d=()=>{let d=a[b];c!==d&&(l("SCROLL"),j()),c=d};return a.addEventListener("scroll",d),()=>a.removeEventListener("scroll",d)}},[h.viewport,i,l,j]),(0,d.jsx)(J.C,{present:f||"hidden"!==k,children:(0,d.jsx)(ab,{"data-state":"hidden"===k?"hidden":"visible",...g,ref:b,onPointerEnter:(0,P.mK)(a.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:(0,P.mK)(a.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),aa=e.forwardRef((a,b)=>{let c=U(Y,a.__scopeScrollArea),{forceMount:f,...g}=a,[h,i]=e.useState(!1),j="horizontal"===a.orientation,k=at(()=>{if(c.viewport){let a=c.viewport.offsetWidth<c.viewport.scrollWidth,b=c.viewport.offsetHeight<c.viewport.scrollHeight;i(j?a:b)}},10);return au(c.viewport,k),au(c.content,k),(0,d.jsx)(J.C,{present:f||h,children:(0,d.jsx)(ab,{"data-state":h?"visible":"hidden",...g,ref:b})})}),ab=e.forwardRef((a,b)=>{let{orientation:c="vertical",...f}=a,g=U(Y,a.__scopeScrollArea),h=e.useRef(null),i=e.useRef(0),[j,k]=e.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),l=ao(j.viewport,j.content),m={...f,sizes:j,onSizesChange:k,hasThumb:!!(l>0&&l<1),onThumbChange:a=>h.current=a,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:a=>i.current=a};function n(a,b){return function(a,b,c,d="ltr"){let e=ap(c),f=b||e/2,g=c.scrollbar.paddingStart+f,h=c.scrollbar.size-c.scrollbar.paddingEnd-(e-f),i=c.content-c.viewport;return ar([g,h],"ltr"===d?[0,i]:[-1*i,0])(a)}(a,i.current,j,b)}return"horizontal"===c?(0,d.jsx)(ac,{...m,ref:b,onThumbPositionChange:()=>{if(g.viewport&&h.current){let a=aq(g.viewport.scrollLeft,j,g.dir);h.current.style.transform=`translate3d(${a}px, 0, 0)`}},onWheelScroll:a=>{g.viewport&&(g.viewport.scrollLeft=a)},onDragScroll:a=>{g.viewport&&(g.viewport.scrollLeft=n(a,g.dir))}}):"vertical"===c?(0,d.jsx)(ad,{...m,ref:b,onThumbPositionChange:()=>{if(g.viewport&&h.current){let a=aq(g.viewport.scrollTop,j);h.current.style.transform=`translate3d(0, ${a}px, 0)`}},onWheelScroll:a=>{g.viewport&&(g.viewport.scrollTop=a)},onDragScroll:a=>{g.viewport&&(g.viewport.scrollTop=n(a))}}):null}),ac=e.forwardRef((a,b)=>{let{sizes:c,onSizesChange:f,...g}=a,h=U(Y,a.__scopeScrollArea),[i,j]=e.useState(),k=e.useRef(null),l=(0,L.s)(b,k,h.onScrollbarXChange);return e.useEffect(()=>{k.current&&j(getComputedStyle(k.current))},[k]),(0,d.jsx)(ag,{"data-orientation":"horizontal",...g,ref:l,sizes:c,style:{bottom:0,left:"rtl"===h.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===h.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":ap(c)+"px",...a.style},onThumbPointerDown:b=>a.onThumbPointerDown(b.x),onDragScroll:b=>a.onDragScroll(b.x),onWheelScroll:(b,c)=>{if(h.viewport){let d=h.viewport.scrollLeft+b.deltaX;a.onWheelScroll(d),function(a,b){return a>0&&a<b}(d,c)&&b.preventDefault()}},onResize:()=>{k.current&&h.viewport&&i&&f({content:h.viewport.scrollWidth,viewport:h.viewport.offsetWidth,scrollbar:{size:k.current.clientWidth,paddingStart:an(i.paddingLeft),paddingEnd:an(i.paddingRight)}})}})}),ad=e.forwardRef((a,b)=>{let{sizes:c,onSizesChange:f,...g}=a,h=U(Y,a.__scopeScrollArea),[i,j]=e.useState(),k=e.useRef(null),l=(0,L.s)(b,k,h.onScrollbarYChange);return e.useEffect(()=>{k.current&&j(getComputedStyle(k.current))},[k]),(0,d.jsx)(ag,{"data-orientation":"vertical",...g,ref:l,sizes:c,style:{top:0,right:"ltr"===h.dir?0:void 0,left:"rtl"===h.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":ap(c)+"px",...a.style},onThumbPointerDown:b=>a.onThumbPointerDown(b.y),onDragScroll:b=>a.onDragScroll(b.y),onWheelScroll:(b,c)=>{if(h.viewport){let d=h.viewport.scrollTop+b.deltaY;a.onWheelScroll(d),function(a,b){return a>0&&a<b}(d,c)&&b.preventDefault()}},onResize:()=>{k.current&&h.viewport&&i&&f({content:h.viewport.scrollHeight,viewport:h.viewport.offsetHeight,scrollbar:{size:k.current.clientHeight,paddingStart:an(i.paddingTop),paddingEnd:an(i.paddingBottom)}})}})}),[ae,af]=R(Y),ag=e.forwardRef((a,b)=>{let{__scopeScrollArea:c,sizes:f,hasThumb:g,onThumbChange:h,onThumbPointerUp:i,onThumbPointerDown:j,onThumbPositionChange:k,onDragScroll:l,onWheelScroll:m,onResize:n,...o}=a,p=U(Y,c),[q,r]=e.useState(null),s=(0,L.s)(b,a=>r(a)),t=e.useRef(null),u=e.useRef(""),v=p.viewport,w=f.content-f.viewport,x=(0,M.c)(m),y=(0,M.c)(k),z=at(n,10);function A(a){t.current&&l({x:a.clientX-t.current.left,y:a.clientY-t.current.top})}return e.useEffect(()=>{let a=a=>{let b=a.target;q?.contains(b)&&x(a,w)};return document.addEventListener("wheel",a,{passive:!1}),()=>document.removeEventListener("wheel",a,{passive:!1})},[v,q,w,x]),e.useEffect(y,[f,y]),au(q,z),au(p.content,z),(0,d.jsx)(ae,{scope:c,scrollbar:q,hasThumb:g,onThumbChange:(0,M.c)(h),onThumbPointerUp:(0,M.c)(i),onThumbPositionChange:y,onThumbPointerDown:(0,M.c)(j),children:(0,d.jsx)(I.sG.div,{...o,ref:s,style:{position:"absolute",...o.style},onPointerDown:(0,P.mK)(a.onPointerDown,a=>{0===a.button&&(a.target.setPointerCapture(a.pointerId),t.current=q.getBoundingClientRect(),u.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),A(a))}),onPointerMove:(0,P.mK)(a.onPointerMove,A),onPointerUp:(0,P.mK)(a.onPointerUp,a=>{let b=a.target;b.hasPointerCapture(a.pointerId)&&b.releasePointerCapture(a.pointerId),document.body.style.webkitUserSelect=u.current,p.viewport&&(p.viewport.style.scrollBehavior=""),t.current=null})})})}),ah="ScrollAreaThumb",ai=e.forwardRef((a,b)=>{let{forceMount:c,...e}=a,f=af(ah,a.__scopeScrollArea);return(0,d.jsx)(J.C,{present:c||f.hasThumb,children:(0,d.jsx)(aj,{ref:b,...e})})}),aj=e.forwardRef((a,b)=>{let{__scopeScrollArea:c,style:f,...g}=a,h=U(ah,c),i=af(ah,c),{onThumbPositionChange:j}=i,k=(0,L.s)(b,a=>i.onThumbChange(a)),l=e.useRef(void 0),m=at(()=>{l.current&&(l.current(),l.current=void 0)},100);return e.useEffect(()=>{let a=h.viewport;if(a){let b=()=>{m(),l.current||(l.current=as(a,j),j())};return j(),a.addEventListener("scroll",b),()=>a.removeEventListener("scroll",b)}},[h.viewport,m,j]),(0,d.jsx)(I.sG.div,{"data-state":i.hasThumb?"visible":"hidden",...g,ref:k,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...f},onPointerDownCapture:(0,P.mK)(a.onPointerDownCapture,a=>{let b=a.target.getBoundingClientRect(),c=a.clientX-b.left,d=a.clientY-b.top;i.onThumbPointerDown({x:c,y:d})}),onPointerUp:(0,P.mK)(a.onPointerUp,i.onThumbPointerUp)})});ai.displayName=ah;var ak="ScrollAreaCorner",al=e.forwardRef((a,b)=>{let c=U(ak,a.__scopeScrollArea),e=!!(c.scrollbarX&&c.scrollbarY);return"scroll"!==c.type&&e?(0,d.jsx)(am,{...a,ref:b}):null});al.displayName=ak;var am=e.forwardRef((a,b)=>{let{__scopeScrollArea:c,...f}=a,g=U(ak,c),[h,i]=e.useState(0),[j,k]=e.useState(0),l=!!(h&&j);return au(g.scrollbarX,()=>{let a=g.scrollbarX?.offsetHeight||0;g.onCornerHeightChange(a),k(a)}),au(g.scrollbarY,()=>{let a=g.scrollbarY?.offsetWidth||0;g.onCornerWidthChange(a),i(a)}),l?(0,d.jsx)(I.sG.div,{...f,ref:b,style:{width:h,height:j,position:"absolute",right:"ltr"===g.dir?0:void 0,left:"rtl"===g.dir?0:void 0,bottom:0,...a.style}}):null});function an(a){return a?parseInt(a,10):0}function ao(a,b){let c=a/b;return isNaN(c)?0:c}function ap(a){let b=ao(a.viewport,a.content),c=a.scrollbar.paddingStart+a.scrollbar.paddingEnd;return Math.max((a.scrollbar.size-c)*b,18)}function aq(a,b,c="ltr"){let d=ap(b),e=b.scrollbar.paddingStart+b.scrollbar.paddingEnd,f=b.scrollbar.size-e,g=b.content-b.viewport,h=function(a,[b,c]){return Math.min(c,Math.max(b,a))}(a,"ltr"===c?[0,g]:[-1*g,0]);return ar([0,g],[0,f-d])(h)}function ar(a,b){return c=>{if(a[0]===a[1]||b[0]===b[1])return b[0];let d=(b[1]-b[0])/(a[1]-a[0]);return b[0]+d*(c-a[0])}}var as=(a,b=()=>{})=>{let c={left:a.scrollLeft,top:a.scrollTop},d=0;return!function e(){let f={left:a.scrollLeft,top:a.scrollTop},g=c.left!==f.left,h=c.top!==f.top;(g||h)&&b(),c=f,d=window.requestAnimationFrame(e)}(),()=>window.cancelAnimationFrame(d)};function at(a,b){let c=(0,M.c)(a),d=e.useRef(0);return e.useEffect(()=>()=>window.clearTimeout(d.current),[]),e.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(c,b)},[c,b])}function au(a,b){let c=(0,M.c)(b);(0,O.N)(()=>{let b=0;if(a){let d=new ResizeObserver(()=>{cancelAnimationFrame(b),b=window.requestAnimationFrame(c)});return d.observe(a),()=>{window.cancelAnimationFrame(b),d.unobserve(a)}}},[a,c])}var av=c(24183);let aw=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(V,{ref:e,className:(0,av.cn)("relative overflow-hidden",a),...c,children:[(0,d.jsx)(X,{className:"h-full w-full rounded-[inherit]",children:b}),(0,d.jsx)(ax,{}),(0,d.jsx)(al,{})]}));aw.displayName=V.displayName;let ax=e.forwardRef(({className:a,orientation:b="vertical",...c},e)=>(0,d.jsx)(Z,{ref:e,orientation:b,className:(0,av.cn)("flex touch-none select-none transition-colors","vertical"===b&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===b&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...c,children:(0,d.jsx)(ai,{className:"relative flex-1 rounded-full bg-border"})}));ax.displayName=Z.displayName;var ay=c(77765),az=c(56304);let aA=async(a,b)=>{let{data:c}=await az.u.get(`/messages/conversation/${a}`,{params:b});return c};var aB=c(22340),aC=c(90610),aD=c(28516);let aE=(0,aC.v)()((0,aD.Zr)(a=>({conversations:{},activeConversationId:null,loading:!1,upsertMessageToConversation:(b,c)=>a(a=>{let d=a.conversations[b]||[],e=d.findIndex(a=>a.id===c.id);if(-1===e)return{conversations:{...a.conversations,[b]:[...d,c]}};{let f=[...d];return f[e]=c,{conversations:{...a.conversations,[b]:f}}}}),addMessageToConversation:(b,c)=>a(a=>({conversations:{...a.conversations,[b]:[...a.conversations[b]||[],c]}})),clearConversationMessages:b=>a(a=>({conversations:{...a.conversations,[b]:[]}})),reset:()=>a({conversations:{},activeConversationId:null,loading:!1}),setActiveConversation:b=>a({activeConversationId:b})}),{name:"chat-store",partialize:a=>({activeConversationId:a.activeConversationId}),storage:(0,aD.KU)(()=>localStorage)})),aF=()=>{let{user:a,conversationId:b,currentConversation:c,conversationData:f,memberCount:g,containerRef:h,mainRef:i,chats:j,chatsLoading:k,handleSendMessage:l,isConnected:m,connectionState:n}=(()=>{let{data:a}=(0,aB.sg)(),{data:b}=(0,aB.sg)(),{screenHeight:c,isOverFlow:d,updateOverflow:f}=(a=>{let[b,c]=(0,e.useState)(720),[d,f]=(0,e.useState)(!1),[g,h]=(0,e.useState)(!1);(0,e.useEffect)(()=>{h(!0);let a=()=>{c(window.innerHeight)};return c(window.innerHeight),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[]);let i=a=>{a>b-210?f(!0):a<b-210&&f(!1)};return g?{screenHeight:b,isOverFlow:d,updateOverflow:i}:{screenHeight:720,isOverFlow:!1,updateOverflow:i}})(720),{conversationId:g,currentConversation:h,connectionState:i}=(()=>{let a=(0,w.useParams)(),b=(0,w.useRouter)(),{groupConversations:c,directConversations:d,currentConversation:f,setCurrentConversation:g}=(0,x.w)(),{connectionState:h,joinConversation:i,leaveConversation:j}=(0,y.Us)(),k=a.id??void 0,l=(0,e.useMemo)(()=>{if(k)return c.find(a=>a.id===k)||d.find(a=>a.id===k)},[k,c,d]),m=(0,e.useRef)(void 0),n=(0,e.useRef)(void 0);(0,e.useEffect)(()=>{if(k){if(!l){n.current!==k&&(n.current=k,b.replace("/messages"));return}m.current!==l.id&&(m.current=l.id,g(l))}},[k,l,b,g]);let o=(0,e.useRef)(void 0),p=(0,e.useRef)(void 0),q=(0,e.useRef)(!1);return(0,e.useEffect)(()=>{if(h!==y.KN.CONNECTED)return;let a=f?.id,b=o.current;if(b!==a){if(b&&b!==a&&!q.current){try{q.current=!0,p.current=a,j(String(b))}catch{}return}if(!b&&a&&!q.current)try{i(String(a)),o.current=a}catch{}}},[h,f?.id,i,j]),(0,e.useEffect)(()=>{let a=a=>{let b=a.detail,c=o.current;if(!q.current||!c||b?.conversationId!==c)return;q.current=!1,o.current=void 0;let d=p.current;if(p.current=void 0,h===y.KN.CONNECTED&&d)try{i(String(d)),o.current=d}catch{}};return window.addEventListener("ws-conversation-leave-ack",a),()=>window.removeEventListener("ws-conversation-leave-ack",a)},[h,i]),{conversationId:k,currentConversation:f,connectionState:h}})(),{chats:j,chatsLoading:k}=(a=>{let{data:b,isLoading:c}=((a,b,c)=>(0,ay.I)({queryKey:["messages",a,void 0],queryFn:()=>aA(a,void 0),enabled:!!a,...void 0}))(a),{addMessageToConversation:d,conversations:f}=aE(),g=(0,e.useMemo)(()=>a&&f[a]||[],[f,a]);return{chats:[...(0,e.useMemo)(()=>Array.isArray(b?.data)?b.data.map(b=>({id:String(b.id??""),conversationId:String(b.conversationId??a??""),createdAt:b.createdAt?new Date(b.createdAt).toISOString():new Date().toISOString(),...void 0!==b.fileName&&{fileName:b.fileName},...void 0!==b.senderAvatar&&{senderAvatar:b.senderAvatar},senderId:String(b.senderId??""),...void 0!==b.senderName&&{senderName:b.senderName},...void 0!==b.text&&{text:b.text},...void 0!==b.url&&{url:b.url}})):[],[b?.data,a]),...g],chatsLoading:c,addMessageToConversation:d}})(g),{conversationData:l,conversationLoading:m,memberCount:n}=(a=>{let{data:b,isLoading:c}=(0,v.Pp)(a,{enabled:!!a}),d=(0,e.useMemo)(()=>b?.members?b.members.length:0,[b?.members]);return{conversationData:b,conversationLoading:c,memberCount:d}})(g),{containerRef:o,mainRef:p,scrollToBottom:q,scrollToBottomOnUpdate:r}=(()=>{let a=(0,e.useRef)(null),b=(0,e.useRef)(null);return{containerRef:a,mainRef:b,scrollToBottom:()=>{a.current?.scrollIntoView({behavior:"smooth",block:"start"}),b.current?.scrollIntoView({behavior:"smooth",block:"start"})},scrollToBottomOnUpdate:()=>{b.current?.scrollIntoView({behavior:"smooth"})}}})(),{formData:s,setFormData:t}=(()=>{let[a,b]=(0,e.useState)({message:""}),[c,d]=(0,e.useState)(!1),[f,g]=(0,e.useState)(""),[h,i]=(0,e.useState)(null),[j,k]=(0,e.useState)("");return(0,e.useEffect)(()=>{c&&(z.oR.warn(f),g(""),d(!1))},[c,f]),(0,e.useEffect)(()=>()=>{i(null),k(""),b({message:""}),d(!1),g("")},[]),{formData:a,setFormData:b,noti:c,setNoti:d,message:f,setMessage:g,file:h,setFile:i,fileName:j,setFileName:k}})(),u=((a,b,c,d)=>{let{sendMessage:f,isConnected:g,error:h}=(0,y.Us)(),i=(0,e.useCallback)(async e=>{if(b?.id&&""!==e&&a&&g())try{f(a,e),c({message:""}),d()}catch(a){z.oR.error("Failed to send message")}else g()||z.oR.warn("Not connected to chat server")},[b?.id,a,g,f,c,d]);return(0,e.useEffect)(()=>{h&&z.oR.error(`WebSocket Error: ${h}`)},[h]),{handleSendMessage:i,isConnected:g(),error:h}})(g,a,t,q);return(a=>{let{upsertMessageToConversation:b}=aE();(0,e.useEffect)(()=>{let c=c=>{let d=c.detail;if(a&&String(d.conversationId)===String(a)){let c={id:String(d.id),conversationId:String(d.conversationId),senderId:String(d.senderId),...void 0!==d.senderName&&{senderName:d.senderName},...void 0!==d.senderAvatar&&{senderAvatar:d.senderAvatar},...void 0!==d.text&&{text:d.text},createdAt:d.createdAt,...void 0!==d.url&&{url:d.url},...void 0!==d.fileName&&{fileName:d.fileName}};b(String(a),c)}};return window.addEventListener("chat-message",c),()=>{window.removeEventListener("chat-message",c)}},[a,b])})(g),(0,e.useEffect)(()=>{void 0!==j&&j?.length&&q()},[j?.length,q]),(0,e.useEffect)(()=>{r()},[j,r]),(0,e.useEffect)(()=>{r()},[k,r]),{sessionUser:a,user:b,conversationId:g,currentConversation:h,conversationData:l,conversationLoading:m,memberCount:n,chats:j,chatsLoading:k,connectionState:i,...u,formData:s,setFormData:t,screenHeight:c,isOverFlow:d,updateOverflow:f,containerRef:o,mainRef:p,handleSendMessage:u.handleSendMessage}})();return(0,d.jsxs)("div",{className:"w-full h-full flex flex-col bg-background",children:[(0,d.jsx)(A,{id:String(b),name:String(c?.name),isGroup:c?.type==="group",avatar:c?.avatar??"",participantCount:g,members:f?.members,ownerId:f?.ownerId,...a?.id!==void 0&&{currentUserId:a.id}}),n===y.KN.CONNECTING&&(0,d.jsx)("div",{className:"px-5 py-2 bg-blue-50 border-b border-blue-200",children:(0,d.jsx)("div",{className:"text-sm text-blue-600",children:"Connecting to chat server..."})}),n===y.KN.ERROR&&(0,d.jsx)("div",{className:"px-chat-outer py-2 bg-red-50 border-b border-red-200",children:(0,d.jsx)("div",{className:"text-sm text-chat-error font-normal",children:"Connection error"})}),(0,d.jsx)(aw,{ref:h,className:"flex-1 p-chat-outer",children:k?(0,d.jsx)(D,{isGroup:!0}):(0,d.jsxs)("div",{className:"space-y-0",children:[a?.id&&j.map(b=>(0,d.jsx)(B,{message:b,isGroup:!0,userId:a.id},b.id)),(0,d.jsx)("div",{ref:i,className:"h-0"})]})}),(0,d.jsx)(H,{onSendMessage:l,isConnected:m,disabled:n===y.KN.ERROR})]})}},79428:a=>{"use strict";a.exports=require("buffer")},79551:a=>{"use strict";a.exports=require("url")},79646:a=>{"use strict";a.exports=require("child_process")},81630:a=>{"use strict";a.exports=require("http")},83997:a=>{"use strict";a.exports=require("tty")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},91645:a=>{"use strict";a.exports=require("net")},94735:a=>{"use strict";a.exports=require("events")}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[320,167,86,817,683,764],()=>b(b.s=3131));module.exports=c})();